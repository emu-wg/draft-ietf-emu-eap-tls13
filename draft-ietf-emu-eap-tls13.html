<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Using EAP-TLS with TLS 1.3 </title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements and Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Protocol Overview">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Overview of the EAP-TLS Conversation">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Mutual Authentication">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 Ticket Establishment">
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 Resumption">
<link href="#rfc.section.2.1.4" rel="Chapter" title="2.1.4 Termination">
<link href="#rfc.section.2.1.5" rel="Chapter" title="2.1.5 No Peer Authentication">
<link href="#rfc.section.2.1.6" rel="Chapter" title="2.1.6 Hello Retry Request">
<link href="#rfc.section.2.1.7" rel="Chapter" title="2.1.7 Identity">
<link href="#rfc.section.2.1.8" rel="Chapter" title="2.1.8 Privacy">
<link href="#rfc.section.2.1.9" rel="Chapter" title="2.1.9 Fragmentation">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Identity Verification">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Key Hierarchy">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Parameter Negotiation and Compliance Requirements">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 EAP State Machines">
<link href="#rfc.section.3" rel="Chapter" title="3 Detailed Description of the EAP-TLS Protocol">
<link href="#rfc.section.4" rel="Chapter" title="4 IANA considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Security Claims">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Peer and Server Identities">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Certificate Validation">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Certificate Revocation">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Packet Modification Attacks">
<link href="#rfc.section.5.6" rel="Chapter" title="5.6 Authorization">
<link href="#rfc.section.5.7" rel="Chapter" title="5.7 Resumption">
<link href="#rfc.section.5.8" rel="Chapter" title="5.8 Privacy Considerations">
<link href="#rfc.section.5.9" rel="Chapter" title="5.9 Pervasive Monitoring">
<link href="#rfc.section.5.10" rel="Chapter" title="5.10 Discovered Vulnerabilities">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative references">
<link href="#rfc.appendix.A" rel="Chapter" title="A Updated references">
<link href="#rfc.acknowledgments" rel="Chapter">
<link href="#rfc.contributors" rel="Chapter">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.9.6 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Mattsson, J. and M. Sethi" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-emu-eap-tls13-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2021-08" />
  <meta name="dct.abstract" content="The Extensible Authentication Protocol (EAP), defined in RFC3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-Transport Layer Security (EAP-TLS) with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security, privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 further improves security and privacy by mandating use of privacy and revocation checking. This document also provides guidance on authorization and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.  " />
  <meta name="description" content="The Extensible Authentication Protocol (EAP), defined in RFC3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-Transport Layer Security (EAP-TLS) with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security, privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 further improves security and privacy by mandating use of privacy and revocation checking. This document also provides guidance on authorization and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">J. Mattsson</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">M. Sethi</td>
</tr>
<tr>
<td class="left">Updates: 5216 (if approved)</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">January 8, 2021</td>
</tr>
<tr>
<td class="left">Expires: July 12, 2021</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Using EAP-TLS with TLS 1.3 <br />
  <span class="filename">draft-ietf-emu-eap-tls13-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Extensible Authentication Protocol (EAP), defined in RFC3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-Transport Layer Security (EAP-TLS) with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security, privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 further improves security and privacy by mandating use of privacy and revocation checking. This document also provides guidance on authorization and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on July 12, 2021.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2021 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements and Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Protocol Overview</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Overview of the EAP-TLS Conversation</a>
</li>
<ul><li>2.1.1.   <a href="#rfc.section.2.1.1">Mutual Authentication</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">Ticket Establishment</a>
</li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">Resumption</a>
</li>
<li>2.1.4.   <a href="#rfc.section.2.1.4">Termination</a>
</li>
<li>2.1.5.   <a href="#rfc.section.2.1.5">No Peer Authentication</a>
</li>
<li>2.1.6.   <a href="#rfc.section.2.1.6">Hello Retry Request</a>
</li>
<li>2.1.7.   <a href="#rfc.section.2.1.7">Identity</a>
</li>
<li>2.1.8.   <a href="#rfc.section.2.1.8">Privacy</a>
</li>
<li>2.1.9.   <a href="#rfc.section.2.1.9">Fragmentation</a>
</li>
</ul><li>2.2.   <a href="#rfc.section.2.2">Identity Verification</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Key Hierarchy</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Parameter Negotiation and Compliance Requirements</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">EAP State Machines</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Detailed Description of the EAP-TLS Protocol</a>
</li>
<li>4.   <a href="#rfc.section.4">IANA considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Security Claims</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Peer and Server Identities</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Certificate Validation</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Certificate Revocation</a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Packet Modification Attacks</a>
</li>
<li>5.6.   <a href="#rfc.section.5.6">Authorization</a>
</li>
<li>5.7.   <a href="#rfc.section.5.7">Resumption</a>
</li>
<li>5.8.   <a href="#rfc.section.5.8">Privacy Considerations</a>
</li>
<li>5.9.   <a href="#rfc.section.5.9">Pervasive Monitoring</a>
</li>
<li>5.10.   <a href="#rfc.section.5.10">Discovered Vulnerabilities</a>
</li>
</ul><li>6.   <a href="#rfc.references">References</a>
</li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Informative references</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Updated references</a>
</li>
<li><a href="#rfc.acknowledgments">Acknowledgments</a>
</li>
<li><a href="#rfc.contributors">Contributors</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The Extensible Authentication Protocol (EAP), defined in <a href="#RFC3748" class="xref">[RFC3748]</a>, provides a standard mechanism for support of multiple authentication methods. EAP-Transport Layer Security (EAP-TLS) <a href="#RFC5216" class="xref">[RFC5216]</a> specifies an EAP authentication method with certificate-based mutual authentication utilizing the TLS handshake protocol for cryptographic algorithms and protocol version negotiation, mutual authentication, and establishment of shared secret keying material. EAP-TLS is widely supported for authentication and key establishment in IEEE 802.11 <a href="#IEEE-802.11" class="xref">[IEEE-802.11]</a> (Wi-Fi) and IEEE 802.1AE <a href="#IEEE-802.1AE" class="xref">[IEEE-802.1AE]</a> (MACsec) networks using IEEE 802.1X <a href="#IEEE-802.1X" class="xref">[IEEE-802.1X]</a> and it's the default mechanism for certificate based authentication in 3GPP 5G <a href="#TS.33.501" class="xref">[TS.33.501]</a> and MulteFire <a href="#MulteFire" class="xref">[MulteFire]</a> networks. Many other EAP methods such as EAP-FAST <a href="#RFC4851" class="xref">[RFC4851]</a>, EAP-TTLS <a href="#RFC5281" class="xref">[RFC5281]</a>, TEAP <a href="#RFC7170" class="xref">[RFC7170]</a>, and PEAP <a href="#PEAP" class="xref">[PEAP]</a> depend on TLS and EAP-TLS.</p>
<p id="rfc.section.1.p.2">EAP-TLS <a href="#RFC5216" class="xref">[RFC5216]</a> references TLS 1.0 <a href="#RFC2246" class="xref">[RFC2246]</a> and TLS 1.1 <a href="#RFC4346" class="xref">[RFC4346]</a>, but can also work with TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>. TLS 1.0 and 1.1 are formally deprecated and prohibited to negotiate and use <a href="#I-D.ietf-tls-oldversions-deprecate" class="xref">[I-D.ietf-tls-oldversions-deprecate]</a>. Weaknesses found in TLS 1.2, as well as new requirements for security, privacy, and reduced latency has led to the specification of TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a>, which obsoletes TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>. TLS 1.3 is in large parts a complete remodeling of the TLS handshake protocol including a different message flow, different handshake messages, different key schedule, different cipher suites, different resumption, different privacy protection, and record padding. This means that significant parts of the normative text in the previous EAP-TLS specification <a href="#RFC5216" class="xref">[RFC5216]</a> are not applicable to EAP-TLS with TLS 1.3 (or higher). Therefore, aspects such as resumption, privacy handling, and key derivation need to be appropriately addressed for EAP-TLS with TLS 1.3 (or higher).</p>
<p id="rfc.section.1.p.3">This document defines how to use EAP-TLS with TLS 1.3 (or higher) and does not change how EAP-TLS is used with older versions of TLS. We do however provide additional guidance on authorization and resumption for EAP-TLS in general (regardless of the underlying TLS version used). While this document updates EAP-TLS <a href="#RFC5216" class="xref">[RFC5216]</a>, it remains backwards compatible with it and existing implementations of EAP-TLS. This document only describes differences compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.1.p.4">In addition to the improved security and privacy offered by TLS 1.3, there are other significant benefits of using EAP-TLS with TLS 1.3. Privacy is mandatory and achieved without any additional round-trips, revocation checking is mandatory and simplified with OCSP stapling, and TLS 1.3 introduces more possibilities to reduce fragmentation when compared to earlier versions of TLS.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements and Terminology</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<p id="rfc.section.1.1.p.2">Readers are expected to be familiar with the terms and concepts used in EAP-TLS <a href="#RFC5216" class="xref">[RFC5216]</a> and TLS <a href="#RFC8446" class="xref">[RFC8446]</a>. The term EAP-TLS peer is used for the entity acting as EAP peer and TLS client. The term EAP-TLS server is used for the entity acting as EAP server and TLS server.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Protocol Overview</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Overview of the EAP-TLS Conversation</h1>
<p id="rfc.section.2.1.p.1">This section updates Section 2.1 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.p.2">TLS 1.3 changes both the message flow and the handshake messages compared to earlier versions of TLS. Therefore, much of Section 2.1 of <a href="#RFC5216" class="xref">[RFC5216]</a> does not apply for TLS 1.3 (or higher).</p>
<p id="rfc.section.2.1.p.3">After receiving an EAP-Request packet with EAP-Type=EAP-TLS as described in <a href="#RFC5216" class="xref">[RFC5216]</a> the conversation will continue with the TLS handshake protocol encapsulated in the data fields of EAP-Response and EAP-Request packets. When EAP-TLS is used with TLS version 1.3 or higher, the formatting and processing of the TLS handshake SHALL be done as specified in that version of TLS. This document only lists additional and different requirements, restrictions, and processing compared to <a href="#RFC8446" class="xref">[RFC8446]</a> and <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> Mutual Authentication</h1>
<p id="rfc.section.2.1.1.p.1">This section updates Section 2.1.1 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.1.p.2">The EAP-TLS server MUST authenticate with a certificate and SHOULD require the EAP-TLS peer to authenticate with a certificate. Certificates can be of any type supported by TLS including raw public keys. Pre-Shared Key (PSK) authentication SHALL NOT be used except for resumption. SessionID is deprecated in TLS 1.3 and the EAP-TLS server SHALL ignore the legacy_session_id field if TLS 1.3 is negotiated. TLS 1.3 introduced early application data which is not used in EAP-TLS. A EAP-TLS server which receives an "early_data" extension MUST ignore the extension or respond with a HelloRetryRequest as described in Section 4.2.10 of <a href="#RFC8446" class="xref">[RFC8446]</a>. Resumption is handled as described in <a href="#resumption" class="xref">Section 2.1.3</a>. The EAP-TLS server commits to not send any more handshake messages by sending a Commitment Message (an encrypted TLS record with the application data 0x00), see <a href="#state" class="xref">Section 2.5</a>. After the EAP-TLS server has recieved a EAP-Response to the EAP-Request containing the Commitment Message, the EAP-TLS server sends EAP-Success.</p>
<p id="rfc.section.2.1.1.p.3">In the case where EAP-TLS with mutual authentication is successful (and neither HelloRetryRequest nor Post-Handshake messages are sent) the conversation will appear as shown in <a href="#figbase1" class="xref">Figure 1</a>. </p>
<div id="rfc.figure.1"></div>
<div id="figbase1"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)                --------&gt;
                              &lt;--------               EAP-Success
</pre>
<p class="figure">Figure 1: EAP-TLS mutual authentication</p>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> <a href="#ticket" id="ticket">Ticket Establishment</a>
</h1>
<p id="rfc.section.2.1.2.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.2.p.2">To enable resumption when using EAP-TLS with TLS 1.3, the EAP-TLS server MUST send a NewSessionTicket message (containing a PSK and other parameters) in the initial authentication. The NewSessionTicket is sent after the EAP-TLS server has received the Finished message in the initial authentication. The NewSessionTicket message MUST NOT include an "early_data" extension.</p>
<p id="rfc.section.2.1.2.p.3">In the case where EAP-TLS with mutual authentication and ticket establishment is successful, the conversation will appear as shown in <a href="#figbase2" class="xref">Figure 2</a>.</p>
<div id="rfc.figure.2"></div>
<div id="figbase2"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                              &lt;--------              TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)                --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                            (TLS NewSessionTicket,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS             --------&gt;
                              &lt;--------               EAP-Success
</pre>
<p class="figure">Figure 2: EAP-TLS ticket establishment</p>
<h1 id="rfc.section.2.1.3">
<a href="#rfc.section.2.1.3">2.1.3.</a> <a href="#resumption" id="resumption">Resumption</a>
</h1>
<p id="rfc.section.2.1.3.p.1">This section updates Section 2.1.2 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.3.p.2">TLS 1.3 replaces the session resumption mechanisms in earlier versions of TLS with a new PSK exchange. When EAP-TLS is used with TLS version 1.3 or higher, EAP-TLS SHALL use a resumption mechanism compatible with that version of TLS.</p>
<p id="rfc.section.2.1.3.p.3">For TLS 1.3, resumption is described in Section 2.2 of <a href="#RFC8446" class="xref">[RFC8446]</a>. If the client has received a NewSessionTicket message from the EAP-TLS server, the client can use the PSK identity received in the ticket to negotiate the use of the associated PSK. If the EAP-TLS server accepts it, then the security context of the new connection is tied to the original connection and the key derived from the initial handshake is used to bootstrap the cryptographic state instead of a full handshake. It is left up to the EAP-TLS peer whether to use resumption, but it is RECOMMENDED that the EAP-TLS server accept resumption as long as the ticket is valid. However, the EAP-TLS server MAY choose to require a full authentication. EAP-TLS peers and EAP-TLS servers SHOULD follow the client tracking preventions in Appendix C.4 of <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<p id="rfc.section.2.1.3.p.4">It is RECOMMENDED to use a Network Access Identifiers (NAIs) with the same realm in the resumption and the original full authentication. This requirement allows EAP packets to be routable to the same destination as the original full authentication. If this recommendation is not followed, resumption is likely to be impossible. When NAI reuse can be done without privacy implications, it is RECOMMENDED to use the same anonymous NAI in the resumption, as was used in the original full authentication <a href="#RFC7542" class="xref">[RFC7542]</a>. For example, the NAI @realm can safely be reused since it does not provide any specific information to associate a user's resumption attempt with the original full authentication. However, reusing the NAI P2ZIM2F+OEVAO21nNWg2bVpgNnU=@realm can allow a potential attacker to associate the resumption attempt with the original full authentication. The TLS PSK identity is typically derived by the TLS implementation and may be an opaque blob without a routable realm. The TLS PSK identity is therefore in general unsuitable for deriving a NAI to use in the Identity Response.</p>
<p id="rfc.section.2.1.3.p.5">A subsequent authentication using resumption, where both sides authenticate successfully (without the issuance of more resumption tickets) is shown in <a href="#figresumption" class="xref">Figure 3</a>.</p>
<div id="rfc.figure.3"></div>
<div id="figresumption"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                                     TLS Finished,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Finished)                --------&gt;
                              &lt;--------               EAP-Success
</pre>
<p class="figure">Figure 3: EAP-TLS resumption</p>
<p id="rfc.section.2.1.3.p.6">As specified in Section 2.2 of <a href="#RFC8446" class="xref">[RFC8446]</a>, the EAP-TLS peer SHOULD supply a "key_share" extension when attempting resumption, which allows the EAP-TLS server to potentially decline resumption and fall back to a full handshake. If the EAP-TLS peer did not supply a "key_share" extension when attempting resumption, the EAP-TLS server needs to reject the ClientHello and the EAP-TLS peer needs to restart a full handshake. The message flow in this case is given by <a href="#figterm1" class="xref">Figure 4</a> followed by <a href="#figbase1" class="xref">Figure 1</a>.</p>
<p id="rfc.section.2.1.3.p.7">Also during resumption, the EAP-TLS server can respond with a Hello Retry Request (see <a href="#helloretry" class="xref">Section 2.1.6</a>) or issue a new ticket (see <a href="#ticket" class="xref">Section 2.1.2</a>)</p>
<h1 id="rfc.section.2.1.4">
<a href="#rfc.section.2.1.4">2.1.4.</a> Termination</h1>
<p id="rfc.section.2.1.4.p.1">This section updates Section 2.1.3 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.4.p.2">TLS 1.3 changes both the message flow and the handshake messages compared to earlier versions of TLS. Therefore, some normative text in Section 2.1.3 of <a href="#RFC5216" class="xref">[RFC5216]</a> does not apply for TLS 1.3 or higher. The two paragraphs below replaces the corresponding paragraphs in Section 2.1.3 of <a href="#RFC5216" class="xref">[RFC5216]</a> when EAP-TLS is used with TLS 1.3 or higher. The other paragraphs in Section 2.1.3 of <a href="#RFC5216" class="xref">[RFC5216]</a> still apply with the exception that SessionID is deprecated.  </p>

<ul class="empty">
<li>If the EAP-TLS peer authenticates successfully, the EAP-TLS server MUST send an EAP-Request packet with EAP-Type=EAP-TLS containing TLS records conforming to the version of TLS used. The message flow ends with the EAP-TLS server sending an EAP-Success message.</li>
<li>If the EAP-TLS server authenticates successfully, the EAP-TLS peer MUST send an EAP-Response message with EAP-Type=EAP-TLS containing TLS records conforming to the version of TLS used.</li>
</ul>

<p> </p>
<p id="rfc.section.2.1.4.p.3">Figures <a href="#figterm1" class="xref">4</a>, <a href="#figterm2" class="xref">5</a>, and <a href="#figterm3" class="xref">6</a> illustrate message flows in several cases where the EAP-TLS peer or EAP-TLS server sends a TLS fatal alert message. TLS warning alerts generally mean that the connection can continue normally and does not change the message flow. Note that the party receiving a TLS warning alert may choose to terminate the connection by sending a TLS fatal alert, which may add an extra round-trip, see <a href="#RFC8446" class="xref">[RFC8446]</a>. </p>
<p id="rfc.section.2.1.4.p.4">In the case where the EAP-TLS server rejects the ClientHello with a fatal error, the conversation will appear as shown in <a href="#figterm1" class="xref">Figure 4</a>. The EAP-TLS server can also partly reject the ClientHello with a HelloRetryRequest, see <a href="#helloretry" class="xref">Section 2.1.6</a>.</p>
<div id="rfc.figure.4"></div>
<div id="figterm1"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------          (TLS Fatal Alert)
 EAP-Response/
 EAP-Type=EAP-TLS             --------&gt;
                              &lt;--------               EAP-Failure
</pre>
<p class="figure">Figure 4: EAP-TLS server rejection of ClientHello</p>
<p id="rfc.section.2.1.4.p.5">In the case where EAP-TLS server authentication is unsuccessful, the conversation will appear as shown in <a href="#figterm2" class="xref">Figure 5</a>.  </p>
<div id="rfc.figure.5"></div>
<div id="figterm2"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Fatal Alert)
                              --------&gt;
                              &lt;--------               EAP-Failure
</pre>
<p class="figure">Figure 5: EAP-TLS unsuccessful EAP-TLS server authentication</p>
<p id="rfc.section.2.1.4.p.6">In the case where the EAP-TLS server authenticates to the EAP-TLS peer successfully, but the EAP-TLS peer fails to authenticate to the EAP-TLS server, the conversation will appear as shown in <a href="#figterm3" class="xref">Figure 6</a>.</p>
<div id="rfc.figure.6"></div>
<div id="figterm3"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;

                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)                --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------          (TLS Fatal Alert)
 EAP-Response/
 EAP-Type=EAP-TLS             --------&gt;
                              &lt;--------               EAP-Failure
</pre>
<p class="figure">Figure 6: EAP-TLS unsuccessful client authentication</p>
<h1 id="rfc.section.2.1.5">
<a href="#rfc.section.2.1.5">2.1.5.</a> No Peer Authentication</h1>
<p id="rfc.section.2.1.5.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.5.p.2">In the case where EAP-TLS is used without peer authentication (e.g., emergency services, as described in <a href="#RFC7406" class="xref">[RFC7406]</a>) the conversation will appear as shown in <a href="#figbase3" class="xref">Figure 7</a>.</p>
<div id="rfc.figure.7"></div>
<div id="figbase3"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Finished)                --------&gt;
                              &lt;--------               EAP-Success
</pre>
<p class="figure">Figure 7: EAP-TLS without peer authentication</p>
<h1 id="rfc.section.2.1.6">
<a href="#rfc.section.2.1.6">2.1.6.</a> <a href="#helloretry" id="helloretry">Hello Retry Request</a>
</h1>
<p id="rfc.section.2.1.6.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.6.p.2">As defined in TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a>, EAP-TLS servers can send a HelloRetryRequest message in response to a ClientHello if the EAP-TLS server finds an acceptable set of parameters but the initial ClientHello does not contain all the needed information to continue the handshake. One use case is if the EAP-TLS server does not support the groups in the "key_share" extension (or there is no "key_share" extension), but supports one of the groups in the "supported_groups" extension. In this case the client should send a new ClientHello with a "key_share" that the EAP-TLS server supports.</p>
<p id="rfc.section.2.1.6.p.3">The case of a successful EAP-TLS mutual authentication after the EAP-TLS server has sent a HelloRetryRequest message is shown in <a href="#fighelloretryrequest" class="xref">Figure 8</a>. Note the extra round-trip as a result of the HelloRetryRequest.</p>
<div id="rfc.figure.8"></div>
<div id="fighelloretryrequest"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                           (TLS HelloRetryRequest)
                              &lt;--------
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished,
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)                --------&gt;
                              &lt;--------               EAP-Success
</pre>
<p class="figure">Figure 8: EAP-TLS with Hello Retry Request</p>
<h1 id="rfc.section.2.1.7">
<a href="#rfc.section.2.1.7">2.1.7.</a> Identity</h1>
<p id="rfc.section.2.1.7.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.7.p.2">It is RECOMMENDED to use anonymous NAIs <a href="#RFC7542" class="xref">[RFC7542]</a> in the Identity Response as such identities are routable and privacy-friendly. While opaque blobs are allowed by <a href="#RFC3748" class="xref">[RFC3748]</a>, such identities are NOT RECOMMENDED as they are not routable and should only be considered in local deployments where the EAP-TLS peer, EAP authenticator, and EAP-TLS server all belong to the same network. Many client certificates contain an identity such as an email address, which is already in NAI format. When the client certificate contains a NAI as subject name or alternative subject name, an anonymous NAI SHOULD be derived from the NAI in the certificate, see <a href="#privacy" class="xref">Section 2.1.8</a>. More details on identities are described in Sections <a href="#resumption" class="xref">2.1.3</a>, <a href="#privacy" class="xref">2.1.8</a>, <a href="#identity" class="xref">2.2</a>, and <a href="#privcon" class="xref">5.8</a>.</p>
<h1 id="rfc.section.2.1.8">
<a href="#rfc.section.2.1.8">2.1.8.</a> <a href="#privacy" id="privacy">Privacy</a>
</h1>
<p id="rfc.section.2.1.8.p.1">This section updates Section 2.1.4 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.8.p.2">TLS 1.3 significantly improves privacy when compared to earlier versions of TLS by forbidding cipher suites without confidentiality and encrypting large parts of the TLS handshake including the certificate messages.</p>
<p id="rfc.section.2.1.8.p.3">EAP-TLS peer and server implementations supporting TLS 1.3 or higher MUST support anonymous NAIs (Network Access Identifiers) (Section 2.4 in <a href="#RFC7542" class="xref">[RFC7542]</a>) and a client supporting TLS 1.3 MUST NOT send its username in cleartext in the Identity Response. Following <a href="#RFC7542" class="xref">[RFC7542]</a>, it is RECOMMENDED to omit the username (i.e., the NAI is @realm), but other constructions such as a fixed username (e.g. anonymous@realm) or an encrypted username (e.g., xCZINCPTK5+7y81CrSYbPg+RKPE3OTrYLn4AQc4AC2U=@realm) are allowed. Note that the NAI MUST be a UTF-8 string as defined by the grammar in Section 2.2 of <a href="#RFC7542" class="xref">[RFC7542]</a>.</p>
<p id="rfc.section.2.1.8.p.4">As the certificate messages in TLS 1.3 are encrypted, there is no need to send an empty certificate_list and perform a second handshake for privacy (as needed by EAP-TLS with earlier versions of TLS). When EAP-TLS is used with TLS version 1.3 or higher the EAP-TLS peer and EAP-TLS server SHALL follow the processing specified by the used version of TLS. For TLS 1.3 this means that the EAP-TLS peer only sends an empty certificate_list if it does not have an appropriate certificate to send, and the EAP-TLS server MAY treat an empty certificate_list as a terminal condition.</p>
<p id="rfc.section.2.1.8.p.5">EAP-TLS with TLS 1.3 is always used with privacy. This does not add any extra round-trips and the message flow with privacy is just the normal message flow as shown in <a href="#figbase1" class="xref">Figure 1</a>.</p>
<h1 id="rfc.section.2.1.9">
<a href="#rfc.section.2.1.9">2.1.9.</a> Fragmentation</h1>
<p id="rfc.section.2.1.9.p.1">This section updates Section 2.1.5 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.1.9.p.2">Including ContentType and ProtocolVersion a single TLS record may be up to 16387 octets in length. EAP-TLS fragmentation support is provided through addition of a flags octet within the EAP-Response and EAP-Request packets, as well as a TLS Message Length field of four octets. Implementations MUST NOT set the L bit in unfragmented messages, but MUST accept unfragmented messages with and without the L bit set.</p>
<p id="rfc.section.2.1.9.p.3">Some EAP implementations and access networks may limit the number of EAP packet exchanges that can be handled. To avoid fragmentation, it is RECOMMENDED to keep the sizes of EAP-TLS peer, EAP-TLS server, and trust anchor certificates small and the length of the certificate chains short. In addition, it is RECOMMENDED to use mechanisms that reduce the sizes of Certificate messages. For a detailed discussion on reducing message sizes to prevent fragmentation, see <a href="#I-D.ietf-emu-eaptlscert" class="xref">[I-D.ietf-emu-eaptlscert]</a>.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#identity" id="identity">Identity Verification</a>
</h1>
<p id="rfc.section.2.2.p.1">This section updates Section 2.2 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.2.p.2">The identity provided in the EAP-Response/Identity is not authenticated by EAP-TLS. Unauthenticated information SHALL NOT be used for accounting purposes or to give authorization. The authenticator and the EAP-TLS server MAY examine the identity presented in EAP-Response/Identity for purposes such as routing and EAP method selection. EAP-TLS servers MAY reject conversations if the identity does not match their policy. Note that this also applies to resumption, see Sections <a href="#resumption" class="xref">2.1.3</a>, <a href="#secauth" class="xref">5.6</a>, and <a href="#secres" class="xref">5.7</a>.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#keyheirarchy" id="keyheirarchy">Key Hierarchy</a>
</h1>
<p id="rfc.section.2.3.p.1">This section updates Section 2.3 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.3.p.2">TLS 1.3 replaces the TLS pseudorandom function (PRF) used in earlier versions of TLS with HKDF and completely changes the Key Schedule. The key hierarchies shown in Section 2.3 of <a href="#RFC5216" class="xref">[RFC5216]</a> are therefore not correct when EAP-TLS is used with TLS version 1.3 or higher. For TLS 1.3 the key schedule is described in Section 7.1 of <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<p id="rfc.section.2.3.p.3">When EAP-TLS is used with TLS version 1.3 or higher the Key_Material, IV, and Method-Id SHALL be derived from the exporter_master_secret using the TLS exporter interface <a href="#RFC5705" class="xref">[RFC5705]</a> (for TLS 1.3 this is defined in Section 7.5 of <a href="#RFC8446" class="xref">[RFC8446]</a>).</p>
<pre>
Type-Code    = 0x0D
MSK          = TLS-Exporter("EXPORTER_EAP_TLS_MSK",
                            Type-Code, 64)
EMSK         = TLS-Exporter("EXPORTER_EAP_TLS_EMSK",
                            Type-Code, 64)
IV           = TLS-Exporter("EXPORTER_EAP_TLS_IV",
                            Type-Code, 64)
Method-Id    = TLS-Exporter("EXPORTER_EAP_TLS_Method-Id",
                            Type-Code, 64)
Session-Id   = Type-Code || Method-Id
</pre>
<p id="rfc.section.2.3.p.4">All other parameters are derived in the same manner as with EAP-TLS <a href="#RFC5216" class="xref">[RFC5216]</a>, Section 2.3. The definitions are repeated below for simplicity:</p>
<pre>
Enc-RECV-Key = MSK(0, 31)
Enc-SEND-Key = MSK(32, 63)
RECV-IV      = IV(0, 31)
SEND-IV      = IV(32, 63)
</pre>
<p id="rfc.section.2.3.p.5">The use of these keys is specific to the lower layer, as described <a href="#RFC5247" class="xref">[RFC5247]</a>.</p>
<p id="rfc.section.2.3.p.6">Note that the key derivation MUST use the length values given above. While in TLS 1.2 and earlier it was possible to truncate the output by requesting less data from the TLS-Exporter function, this practice is not possible with TLS 1.3. If an implementation intends to use only a part of the output of the TLS-Exporter function, then it MUST ask for the full output and then only use the desired part. Failure to do so will result in incorrect values being calculated for the above keying material.</p>
<p id="rfc.section.2.3.p.7">By using the TLS exporter, EAP-TLS can use any TLS 1.3 implementation without having to extract the Master Secret, ClientHello.random, and ServerHello.random in a non-standard way.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Parameter Negotiation and Compliance Requirements</h1>
<p id="rfc.section.2.4.p.1">This section updates Section 2.4 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.4.p.2">TLS 1.3 cipher suites are defined differently than in earlier versions of TLS (see Section B.4 of <a href="#RFC8446" class="xref">[RFC8446]</a>), and the cipher suites discussed in Section 2.4 of <a href="#RFC5216" class="xref">[RFC5216]</a> can therefore not be used when EAP-TLS is used with TLS version 1.3 or higher.</p>
<p id="rfc.section.2.4.p.3">When EAP-TLS is used with TLS version 1.3 or higher, the EAP-TLS peers and EAP-TLS servers MUST comply with the compliance requirements (mandatory-to-implement cipher suites, signature algorithms, key exchange algorithms, extensions, etc.) for the TLS version used. For TLS 1.3 the compliance requirements are defined in Section 9 of <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<p id="rfc.section.2.4.p.4">While EAP-TLS does not protect any application data except for the Commitment Message, the negotiated cipher suites and algorithms MAY be used to secure data as done in other TLS-based EAP methods.</p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#state" id="state">EAP State Machines</a>
</h1>
<p id="rfc.section.2.5.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.2.5.p.2">TLS 1.3 <a href="#RFC8446" class="xref">[RFC8446]</a> introduces Post-Handshake messages. These Post-Handshake messages use the handshake content type and can be sent after the main handshake. One such Post-Handshake message is NewSessionTicket. The NewSessionTicket can be used for resumption. After sending TLS Finished, the EAP-TLS server may send any number of Post-Handshake messages in separate EAP-Requests. To decrease the uncertainty for the EAP-TLS peer, the following procedure MUST be followed:</p>
<p id="rfc.section.2.5.p.3">When an EAP-TLS server has sent its last handshake message (Finished or a Post-Handshake), it commits to not sending any more handshake messages by sending a Commitment Message. The Commitment Message is an encrypted TLS record with application data 0x00 (i.e., a TLS record with TLSPlaintext.type = application_data, TLSPlaintext.length = 1, and TLSPlaintext.fragment = 0x00). Note that the length of the plaintext is greater than the corresponding TLSPlaintext.length due to the inclusion of TLSInnerPlaintext.type and any padding supplied by the sender. EAP-TLS server implementations MUST set TLSPlaintext.fragment to 0x00, but EAP-TLS peer implementations MUST accept any application data as a Commitment Message from the EAP-TLS server to not send any more handshake messages. The Commitment Message may be sent in the same EAP-Request as the last handshake record or in a separate EAP-Request. Sending the Commitment Message in a separate EAP-Request adds an additional round-trip, but may be necessary in TLS implementations that only implement a subset of TLS 1.3. In the case where the EAP-TLS server sends the Commitment Message in a separate EAP-Request, the conversation will appear as shown in <a href="#figsepcommit" class="xref">Figure 9</a>. After sending the Commitment Message, the EAP-TLS server may only send an EAP-Success, an EAP-Failure, or an EAP-Request with a TLS Alert Message.</p>
<div id="rfc.figure.9"></div>
<div id="figsepcommit"></div>
<pre>
 EAP-TLS Peer                                      EAP-TLS Server
                                                      EAP-Request/
                              &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly)  --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------                (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)             --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                              &lt;--------              TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)                --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                              &lt;--------        Commitment Message)
 EAP-Response/
 EAP-Type=EAP-TLS             --------&gt;
                              &lt;--------               EAP-Success
</pre>
<p class="figure">Figure 9: Commit in separate EAP-Request</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Detailed Description of the EAP-TLS Protocol</h1>
<p id="rfc.section.3.p.1">No updates to Section 3 of <a href="#RFC5216" class="xref">[RFC5216]</a>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> IANA considerations</h1>
<p id="rfc.section.4.p.1">This section provides guidance to the Internet Assigned Numbers Authority (IANA) regarding registration of values related to the EAP-TLS 1.3 protocol in accordance with <a href="#RFC8126" class="xref">[RFC8126]</a>.</p>
<p id="rfc.section.4.p.2">This memo requires IANA to add the following labels to the TLS Exporter Label Registry defined by <a href="#RFC5705" class="xref">[RFC5705]</a>. These labels are used in derivation of Key_Material, IV and Method-Id as defined in <a href="#keyheirarchy" class="xref">Section 2.3</a>:</p>
<div id="rfc.table.1"></div>
<div id="exporter-label"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>TLS Exporter Label Registry</caption>
<thead><tr>
<th class="left">Value</th>
<th class="left">DTLS-OK</th>
<th class="left">Recommended</th>
<th class="left">Note</th>
</tr></thead>
<tbody>
<tr>
<td class="left">EXPORTER_EAP_TLS_MSK</td>
<td class="left">N</td>
<td class="left">Y</td>
<td class="left"></td>
</tr>
<tr>
<td class="left"></td>
<td class="left"></td>
<td class="left"></td>
<td class="left"></td>
</tr>
<tr>
<td class="left">EXPORTER_EAP_TLS_EMSK</td>
<td class="left">N</td>
<td class="left">Y</td>
<td class="left"></td>
</tr>
<tr>
<td class="left"></td>
<td class="left"></td>
<td class="left"></td>
<td class="left"></td>
</tr>
<tr>
<td class="left">EXPORTER_EAP_TLS_IV</td>
<td class="left">N</td>
<td class="left">Y</td>
<td class="left"></td>
</tr>
<tr>
<td class="left"></td>
<td class="left"></td>
<td class="left"></td>
<td class="left"></td>
</tr>
<tr>
<td class="left">EXPORTER_EAP_TLS_Method-Id</td>
<td class="left">N</td>
<td class="left">Y</td>
<td class="left"></td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#seccon" id="seccon">Security Considerations</a>
</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Security Claims</h1>
<p id="rfc.section.5.1.p.1">Using EAP-TLS with TLS 1.3 does not change the security claims for EAP-TLS as given in Section 5.1 of <a href="#RFC5216" class="xref">[RFC5216]</a>. However, it strengthens several of the claims as described in the following updates to the notes given in Section 5.1 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.5.1.p.2">[1] Mutual authentication: By mandating revocation checking of certificates, the authentication in EAP-TLS with TLS 1.3 is stronger as authentication with revoked certificates will always fail.</p>
<p id="rfc.section.5.1.p.3">[2] Confidentiality: The TLS 1.3 handshake offers much better confidentiality than earlier versions of TLS. The mandatory to implement cipher suites of <a href="#RFC8446" class="xref">[RFC8446]</a> ensure confidentiality. TLS 1.3 also encrypts certificates and some of the extensions. When using EAP-TLS with TLS 1.3, the use of privacy is mandatory and does not cause any additional round-trips.</p>
<p id="rfc.section.5.1.p.4">[3] Key strength: TLS 1.3 forbids algorithms such as RC4 and MD5 which have known weaknesses. TLS 1.3 only supports cryptographic algorithms offering at least 112-bit security, see <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<p id="rfc.section.5.1.p.5">[4] Cryptographic Negotiation: TLS 1.3 increases the number of cryptographic parameters that are negotiated in the handshake. When EAP-TLS is used with TLS 1.3, EAP-TLS inherits the cryptographic negotiation of AEAD algorithm, HKDF hash algorithm, key exchange groups, and signature algorithm, see Section 4.1.1 of <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Peer and Server Identities</h1>
<p id="rfc.section.5.2.p.1">No updates to section 5.2 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Certificate Validation</h1>
<p id="rfc.section.5.3.p.1">No updates to section 5.3 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Certificate Revocation</h1>
<p id="rfc.section.5.4.p.1">This section updates Section 5.4 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.5.4.p.2">While certificates may have long validity periods, there are a number of reasons (e.g., key compromise, CA compromise, privilege withdrawn, etc.) why EAP-TLS peer, EAP-TLS server, or sub-CA certificates have to be revoked before their expiry date. Revocation of the EAP-TLS server&#8217;s certificate is complicated by the fact that the EAP-TLS peer may not have Internet connectivity until authentication completes.</p>
<p id="rfc.section.5.4.p.3">When EAP-TLS is used with TLS 1.3, the revocation status of all the certificates in the certificate chains MUST be checked.</p>
<p id="rfc.section.5.4.p.4">EAP-TLS servers supporting TLS 1.3 MUST implement Certificate Status Requests (OCSP stapling) as specified in <a href="#RFC6066" class="xref">[RFC6066]</a> and Section 4.4.2.1 of <a href="#RFC8446" class="xref">[RFC8446]</a>. It is RECOMMENDED that EAP-TLS peers and EAP-TLS servers use OCSP stapling for verifying the status of the EAP-TLS server's certificate chain. When an EAP-TLS peer uses Certificate Status Requests to check the revocation status of the EAP-TLSserver's certificate chain it MUST treat a CertificateEntry (except the trust anchor) without a valid CertificateStatus extension as invalid and abort the handshake with an appropriate alert. The OCSP status handling in TLS 1.3 is different from earlier versions of TLS, see Section 4.4.2.1 of <a href="#RFC8446" class="xref">[RFC8446]</a>. In TLS 1.3 the OCSP information is carried in the CertificateEntry containing the associated certificate instead of a separate CertificateStatus message as in <a href="#RFC6066" class="xref">[RFC6066]</a>. This enables sending OCSP information for all certificates in the certificate chain (except the trust anchor).</p>
<p id="rfc.section.5.4.p.5">To enable revocation checking in situations where EAP-TLS peers do not implement or use OCSP stapling, and where network connectivity is not available prior to authentication completion, EAP-TLS peer implementations MUST also support checking for certificate revocation after authentication completes and network connectivity is available, and peers SHOULD utilize this in the absence of other revocation checking mechanisms.</p>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> Packet Modification Attacks</h1>
<p id="rfc.section.5.5.p.1">No updates to Section 5.5 of <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<h1 id="rfc.section.5.6">
<a href="#rfc.section.5.6">5.6.</a> <a href="#secauth" id="secauth">Authorization</a>
</h1>
<p id="rfc.section.5.6.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>. The guidance in this section is relevant for EAP-TLS in general (regardless of the underlying TLS version used).</p>
<p id="rfc.section.5.6.p.2">EAP-TLS is typically encapsulated in other protocols, such as PPP <a href="#RFC1661" class="xref">[RFC1661]</a>, RADIUS <a href="#RFC2865" class="xref">[RFC2865]</a>, Diameter <a href="#RFC6733" class="xref">[RFC6733]</a>, or PANA <a href="#RFC5191" class="xref">[RFC5191]</a>. The encapsulating protocols can also provide additional, non-EAP information to an EAP-TLS server. This information can include, but is not limited to, information about the authenticator, information about the EAP-TLS peer, or information about the protocol layers above or below EAP (MAC addresses, IP addresses, port numbers, WiFi SSID, etc.). EAP-TLS Servers implementing EAP-TLS inside those protocols can make policy decisions and enforce authorization based on a combination of information from the EAP-TLS exchange and non-EAP information.</p>
<p id="rfc.section.5.6.p.3">As noted in <a href="#identity" class="xref">Section 2.2</a>, the identity presented in EAP-Response/Identity is not authenticated by EAP-TLS and is therefore trivial for an attacker to forge, modify, or replay. Authorization and accounting MUST be based on authenticated information such as information in the certificate or the PSK identity and cached data provisioned for resumption as described in <a href="#secres" class="xref">Section 5.7</a>. Note that the requirements for Network Access Identifiers (NAIs) specified in Section 4 of <a href="#RFC7542" class="xref">[RFC7542]</a> still apply and MUST be followed. </p>
<p id="rfc.section.5.6.p.4">EAP-TLS servers MAY reject conversations based on non-EAP information provided by the encapsulating protocol, for example, if the MAC address of the authenticator does not match the expected policy.</p>
<h1 id="rfc.section.5.7">
<a href="#rfc.section.5.7">5.7.</a> <a href="#secres" id="secres">Resumption</a>
</h1>
<p id="rfc.section.5.7.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>. The guidance in this section is relevant for EAP-TLS in general (regardless of the underlying TLS version used).</p>
<p id="rfc.section.5.7.p.2">There are a number of security issues related to resumption that are not described in <a href="#RFC5216" class="xref">[RFC5216]</a>. The problems, guidelines, and requirements in this section therefore applies to all version of TLS.</p>
<p id="rfc.section.5.7.p.3">When resumption occurs, it is based on cached information at the TLS layer. To perform resumption in a secure way, the EAP-TLS peer and EAP-TLS server need to be able to securely retrieve authorization information such as certificate chains from the initial full handshake. We use the term "cached data" to describe such information. Authorization during resumption MUST be based on such cached data. The EAP-TLS peer and EAP-TLS server MAY perform fresh revocation checks on the cached certificate data. Any security policies for authorization MUST be followed also for resumption. The certificates may have been revoked since the initial full handshake and the authorizations of the other party may have been reduced. If the cached revocation data is not sufficiently current, the EAP-TLS peer or EAP-TLS server MAY force a full TLS handshake.</p>
<p id="rfc.section.5.7.p.4">There are two ways to retrieve the cached data from the original full handshake. The first method is that the EAP-TLS server and client cache the information locally. The cached information is identified by an identifier. For TLS versions before 1.3, the identifier can be the session ID, for TLS 1.3, the identifier is the PSK identity. The second method for retrieving cached information is via <a href="#RFC5077" class="xref">[RFC5077]</a> or <a href="#RFC8446" class="xref">[RFC8446]</a>, where the EAP-TLS server avoids storing information locally and instead encapsulates the information into a ticket or PSK which is sent to the client for storage. This ticket or PSK is encrypted using a key that only the EAP-TLS server knows. Note that the client still needs to cache the original handshake information locally and will use the session ID or PSK identity to lookup this information during resumption. However, the EAP-TLS server is able to decrypt the ticket or PSK to obtain the original handshake information.</p>
<p id="rfc.section.5.7.p.5">If the EAP-TLS server or EAP client do not apply any authorization policies, they MAY allow resumption where no cached data is available. In all other cases, they MUST cache data during the initial full authentication to enable resumption. The cached data MUST be sufficient to make authorization decisions during resumption. If cached data cannot be retrieved in a secure way, resumption MUST NOT be done.</p>
<p id="rfc.section.5.7.p.6">The above requirements also apply if the EAP-TLS server expects some system to perform accounting for the session. Since accounting must be tied to an authenticated identity, and resumption does not supply such an identity, accounting is impossible without access to cached data. Therefore systems which expect to perform accounting for the session SHOULD cache an identifier which can be used in subsequent accounting.</p>
<p id="rfc.section.5.7.p.7">As suggested in <a href="#RFC8446" class="xref">[RFC8446]</a>, EAP-TLS peers MUST NOT store resumption PSKs or tickets (and associated cached data) for longer than 7 days, regardless of the PSK or ticket lifetime. The EAP-TLS peer MAY delete them earlier based on local policy. The cached data MAY also be removed on the EAP-TLS server or EAP-TLS peer if any certificate in the certificate chain has been revoked or has expired. In all such cases, an attempt at resumption results in a full TLS handshake instead.</p>
<p id="rfc.section.5.7.p.8">Information from the EAP-TLS exchange (e.g., the identity provided in EAP-Response/Identity) as well as non-EAP information (e.g., IP addresses) may change between the initial full handshake and resumption. This change creates a "time-of-check time-of-use" (TOCTOU) security vulnerability. A malicious or compromised user could supply one set of data during the initial authentication, and a different set of data during resumption, potentially allowing them to obtain access that they should not have.</p>
<p id="rfc.section.5.7.p.9">If any authorization, accounting, or policy decisions were made with information that has changed between the initial full handshake and resumption, and if change may lead to a different decision, such decisions MUST be reevaluated. It is RECOMMENDED that authorization, accounting, and policy decisions are reevaluated based on the information given in the resumption. EAP-TLS servers MAY reject resumption where the information supplied during resumption does not match the information supplied during the original authentication. If a safe decision is not possible, EAP-TLS servers SHOULD reject the resumption and continue with a full handshake.</p>
<p id="rfc.section.5.7.p.10">Section 2.2 and 4.2.11,<a href="#RFC8446" class="xref">[RFC8446]</a> provides security considerations for resumption.</p>
<h1 id="rfc.section.5.8">
<a href="#rfc.section.5.8">5.8.</a> <a href="#privcon" id="privcon">Privacy Considerations</a>
</h1>
<p id="rfc.section.5.8.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.5.8.p.2">TLS 1.3 offers much better privacy than earlier versions of TLS as discussed in <a href="#privacy" class="xref">Section 2.1.8</a>. In this section, we only discuss the privacy properties of EAP-TLS with TLS 1.3. For privacy properties of TLS 1.3 itself, see <a href="#RFC8446" class="xref">[RFC8446]</a>.</p>
<p id="rfc.section.5.8.p.3">EAP-TLS sends the standard TLS 1.3 handshake messages encapsulated in EAP packets. Additionally, the EAP-TLS peer sends an identity in the first EAP-Response. The other fields in the EAP-TLS Request and the EAP-TLS Response packets do not contain any cleartext privacy sensitive information.</p>
<p id="rfc.section.5.8.p.4">Tracking of users by eavesdropping on identity responses or certificates is a well-known problem in many EAP methods. When EAP-TLS is used with TLS 1.3, all certificates are encrypted, and the username part of the identity response is always confidentiality protected (e.g., using anonymous NAIs). Note that even though all certificates are encrypted, the server's identity is only protected against passive attackers while client's identity is protected against both passive and active attackers. As with other EAP methods, even when privacy-friendly identifiers or EAP tunneling is used, the domain name (i.e., the realm) in the NAI is still typically visible. How much privacy sensitive information the domain name leaks is highly dependent on how many other users are using the same domain name in the particular access network. If all EAP-TLS peers have the same domain, no additional information is leaked. If a domain name is used by a small subset of the EAP-TLS peers, it may aid an attacker in tracking or identifying the user.</p>
<p id="rfc.section.5.8.p.5">Without padding, information about the size of the client certificate is leaked from the size of the EAP-TLS packets. The EAP-TLS packets sizes may therefore leak information that can be used to track or identify the user. If all client certificates have the same length, no information is leaked. EAP-TLS peers SHOULD use record padding, see Section 5.4 of <a href="#RFC8446" class="xref">[RFC8446]</a> to reduce information leakage of certificate sizes.</p>
<p id="rfc.section.5.8.p.6">If anonymous NAIs are not used, the privacy-friendly identifiers need to be generated with care. The identities MUST be generated in a cryptographically secure way so that that it is computationally infeasible for an attacker to differentiate two identities belonging to the same user from two identities belonging to different users in the same realm. This can be achieved, for instance, by using random or pseudo-random usernames such as random byte strings or ciphertexts and only using the pseudo-random usernames a single time. Note that the privacy-friendly usernames also MUST NOT include substrings that can be used to relate the identity to a specific user. Similarly, privacy-friendly username MUST NOT be formed by a fixed mapping that stays the same across multiple different authentications.</p>
<p id="rfc.section.5.8.p.7">An EAP-TLS peer with a policy allowing communication with EAP-TLS servers supporting only TLS 1.2 without privacy and with a static RSA key exchange is vulnerable to disclosure of the EAP-TLS peer username. An active attacker can in this case make the EAP-TLS peer believe that an EAP-TLS server supporting TLS 1.3 only supports TLS 1.2 without privacy. The attacker can simply impersonate the EAP-TLS server and negotiate TLS 1.2 with static RSA key exchange and send an TLS alert message when the EAP-TLS peer tries to use privacy by sending an empty certificate message. Since the attacker (impersonating the EAP-TLS server) does not provide a proof-of-possession of the private key until the Finished message when a static RSA key exchange is used, an EAP-TLS peer may inadvertently disclose its identity (username) to an attacker. Therefore, it is RECOMMENDED for EAP-TLS peers to not use EAP-TLS with TLS 1.2 and static RSA based cipher suites without privacy. This implies that an EAP-TLS peer SHOULD NOT continue the handshake if a TLS 1.2 EAP-TLS server sends an EAP-TLS/Request with a TLS alert message in response to an empty certificate message from the peer.</p>
<h1 id="rfc.section.5.9">
<a href="#rfc.section.5.9">5.9.</a> Pervasive Monitoring</h1>
<p id="rfc.section.5.9.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.5.9.p.2">Pervasive monitoring refers to widespread surveillance of users. In the context of EAP-TLS, pervasive monitoring attacks can target EAP-TLS peer devices for tracking them (and their users) as and when they join a network. By encrypting more information and by mandating the use of privacy, TLS 1.3 offers much better protection against pervasive monitoring. In addition to the privacy attacks discussed above, surveillance on a large scale may enable tracking of a user over a wider geographical area and across different access networks. Using information from EAP-TLS together with information gathered from other protocols increases the risk of identifying individual users.</p>
<h1 id="rfc.section.5.10">
<a href="#rfc.section.5.10">5.10.</a> Discovered Vulnerabilities</h1>
<p id="rfc.section.5.10.p.1">This is a new section when compared to <a href="#RFC5216" class="xref">[RFC5216]</a>.</p>
<p id="rfc.section.5.10.p.2">Over the years, there have been several serious attacks on earlier versions of Transport Layer Security (TLS), including attacks on its most commonly used ciphers and modes of operation. <a href="#RFC7457" class="xref">[RFC7457]</a> summarizes the attacks that were known at the time of publishing and <a href="#RFC7525" class="xref">BCP 195</a> provides recommendations for improving the security of deployed services that use TLS. However, many of the attacks are less serious for EAP-TLS as EAP-TLS only uses the TLS handshake and does not protect any application data. EAP-TLS implementations MUST mitigate known attacks. EAP-TLS implementations need to monitor and follow new EAP and TLS related security guidance and requirements such as <a href="#RFC8447" class="xref">[RFC8447]</a>, <a href="#I-D.ietf-tls-oldversions-deprecate" class="xref">[I-D.ietf-tls-oldversions-deprecate]</a>, <a href="#I-D.ietf-tls-md5-sha1-deprecate" class="xref">[I-D.ietf-tls-md5-sha1-deprecate]</a>.</p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="https://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, DOI 10.17487/RFC3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5216">[RFC5216]</b></td>
<td class="top">
<a>Simon, D.</a>, <a>Aboba, B.</a> and <a>R. Hurst</a>, "<a href="https://tools.ietf.org/html/rfc5216">The EAP-TLS Authentication Protocol</a>", RFC 5216, DOI 10.17487/RFC5216, March 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5705">[RFC5705]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc5705">Keying Material Exporters for Transport Layer Security (TLS)</a>", RFC 5705, DOI 10.17487/RFC5705, March 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6066">[RFC6066]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a>, "<a href="https://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>", RFC 6066, DOI 10.17487/RFC6066, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6960">[RFC6960]</b></td>
<td class="top">
<a>Santesson, S.</a>, <a>Myers, M.</a>, <a>Ankney, R.</a>, <a>Malpani, A.</a>, <a>Galperin, S.</a> and <a>C. Adams</a>, "<a href="https://tools.ietf.org/html/rfc6960">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>", RFC 6960, DOI 10.17487/RFC6960, June 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7542">[RFC7542]</b></td>
<td class="top">
<a>DeKok, A.</a>, "<a href="https://tools.ietf.org/html/rfc7542">The Network Access Identifier</a>", RFC 7542, DOI 10.17487/RFC7542, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8126">[RFC8126]</b></td>
<td class="top">
<a>Cotton, M.</a>, <a>Leiba, B.</a> and <a>T. Narten</a>, "<a href="https://tools.ietf.org/html/rfc8126">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8446">[RFC8446]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc8446">The Transport Layer Security (TLS) Protocol Version 1.3</a>", RFC 8446, DOI 10.17487/RFC8446, August 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Informative references</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-emu-eaptlscert">[I-D.ietf-emu-eaptlscert]</b></td>
<td class="top">
<a>Sethi, M.</a>, <a>Mattsson, J.</a> and <a>S. Turner</a>, "<a href="https://tools.ietf.org/html/draft-ietf-emu-eaptlscert-08">Handling Large Certificates and Long Certificate Chains in TLS-based EAP Methods</a>", Internet-Draft draft-ietf-emu-eaptlscert-08, November 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-md5-sha1-deprecate">[I-D.ietf-tls-md5-sha1-deprecate]</b></td>
<td class="top">
<a>Velvindron, L.</a>, <a>Moriarty, K.</a> and <a>A. Ghedini</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-md5-sha1-deprecate-04">Deprecating MD5 and SHA-1 signature hashes in TLS 1.2</a>", Internet-Draft draft-ietf-tls-md5-sha1-deprecate-04, October 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-oldversions-deprecate">[I-D.ietf-tls-oldversions-deprecate]</b></td>
<td class="top">
<a>Moriarty, K.</a> and <a>S. Farrell</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-oldversions-deprecate-11">Deprecating TLSv1.0 and TLSv1.1</a>", Internet-Draft draft-ietf-tls-oldversions-deprecate-11, December 2020.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE-802.11">[IEEE-802.11]</b></td>
<td class="top">
<a>Institute of Electrical and Electronics Engineers</a>, "<a>IEEE Standard for Information technology&#8212;Telecommunications and information exchange between systems Local and metropolitan area networks&#8212;Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications</a>", IEEE Std 802.11-2016 (Revision of IEEE Std 802.11-2012) , December 2016.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE-802.1AE">[IEEE-802.1AE]</b></td>
<td class="top">
<a>Institute of Electrical and Electronics Engineers</a>, "<a>IEEE Standard for Local and metropolitan area networks -- Media Access Control (MAC) Security</a>", IEEE Standard 802.1AE-2018 , December 2018.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE-802.1X">[IEEE-802.1X]</b></td>
<td class="top">
<a>Institute of Electrical and Electronics Engineers</a>, "<a>IEEE Standard for Local and metropolitan area networks -- Port-Based Network Access Control</a>", IEEE Standard 802.1X-2010 , February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="MulteFire">[MulteFire]</b></td>
<td class="top">
<a>MulteFire</a>, "<a>MulteFire Release 1.1 specification</a>", 2019.</td>
</tr>
<tr>
<td class="reference"><b id="PEAP">[PEAP]</b></td>
<td class="top">
<a>Microsoft Corporation</a>, "<a>[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP)</a>", 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1661">[RFC1661]</b></td>
<td class="top">
<a>Simpson, W.</a>, "<a href="https://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>", STD 51, RFC 1661, DOI 10.17487/RFC1661, July 1994.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2246">[RFC2246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>C. Allen</a>, "<a href="https://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>", RFC 2246, DOI 10.17487/RFC2246, January 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2560">[RFC2560]</b></td>
<td class="top">
<a>Myers, M.</a>, <a>Ankney, R.</a>, <a>Malpani, A.</a>, <a>Galperin, S.</a> and <a>C. Adams</a>, "<a href="https://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>", RFC 2560, DOI 10.17487/RFC2560, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2865">[RFC2865]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="https://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, DOI 10.17487/RFC2865, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3280">[RFC3280]</b></td>
<td class="top">
<a>Housley, R.</a>, <a>Polk, W.</a>, <a>Ford, W.</a> and <a>D. Solo</a>, "<a href="https://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 3280, DOI 10.17487/RFC3280, April 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4282">[RFC4282]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Beadles, M.</a>, <a>Arkko, J.</a> and <a>P. Eronen</a>, "<a href="https://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>", RFC 4282, DOI 10.17487/RFC4282, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4346">[RFC4346]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>", RFC 4346, DOI 10.17487/RFC4346, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4851">[RFC4851]</b></td>
<td class="top">
<a>Cam-Winget, N.</a>, <a>McGrew, D.</a>, <a>Salowey, J.</a> and <a>H. Zhou</a>, "<a href="https://tools.ietf.org/html/rfc4851">The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</a>", RFC 4851, DOI 10.17487/RFC4851, May 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5077">[RFC5077]</b></td>
<td class="top">
<a>Salowey, J.</a>, <a>Zhou, H.</a>, <a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/rfc5077">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>", RFC 5077, DOI 10.17487/RFC5077, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5191">[RFC5191]</b></td>
<td class="top">
<a>Forsberg, D.</a>, <a>Ohba, Y.</a>, <a>Patil, B.</a>, <a>Tschofenig, H.</a> and <a>A. Yegin</a>, "<a href="https://tools.ietf.org/html/rfc5191">Protocol for Carrying Authentication for Network Access (PANA)</a>", RFC 5191, DOI 10.17487/RFC5191, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5247">[RFC5247]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Simon, D.</a> and <a>P. Eronen</a>, "<a href="https://tools.ietf.org/html/rfc5247">Extensible Authentication Protocol (EAP) Key Management Framework</a>", RFC 5247, DOI 10.17487/RFC5247, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5281">[RFC5281]</b></td>
<td class="top">
<a>Funk, P.</a> and <a>S. Blake-Wilson</a>, "<a href="https://tools.ietf.org/html/rfc5281">Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</a>", RFC 5281, DOI 10.17487/RFC5281, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6733">[RFC6733]</b></td>
<td class="top">
<a>Fajardo, V.</a>, <a>Arkko, J.</a>, <a>Loughney, J.</a> and <a>G. Zorn</a>, "<a href="https://tools.ietf.org/html/rfc6733">Diameter Base Protocol</a>", RFC 6733, DOI 10.17487/RFC6733, October 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7170">[RFC7170]</b></td>
<td class="top">
<a>Zhou, H.</a>, <a>Cam-Winget, N.</a>, <a>Salowey, J.</a> and <a>S. Hanna</a>, "<a href="https://tools.ietf.org/html/rfc7170">Tunnel Extensible Authentication Protocol (TEAP) Version 1</a>", RFC 7170, DOI 10.17487/RFC7170, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7406">[RFC7406]</b></td>
<td class="top">
<a>Schulzrinne, H.</a>, <a>McCann, S.</a>, <a>Bajko, G.</a>, <a>Tschofenig, H.</a> and <a>D. Kroeselberg</a>, "<a href="https://tools.ietf.org/html/rfc7406">Extensions to the Emergency Services Architecture for Dealing With Unauthenticated and Unauthorized Devices</a>", RFC 7406, DOI 10.17487/RFC7406, December 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7457">[RFC7457]</b></td>
<td class="top">
<a>Sheffer, Y.</a>, <a>Holz, R.</a> and <a>P. Saint-Andre</a>, "<a href="https://tools.ietf.org/html/rfc7457">Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)</a>", RFC 7457, DOI 10.17487/RFC7457, February 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7525">[RFC7525]</b></td>
<td class="top">
<a>Sheffer, Y.</a>, <a>Holz, R.</a> and <a>P. Saint-Andre</a>, "<a href="https://tools.ietf.org/html/rfc7525">Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8447">[RFC8447]</b></td>
<td class="top">
<a>Salowey, J.</a> and <a>S. Turner</a>, "<a href="https://tools.ietf.org/html/rfc8447">IANA Registry Updates for TLS and DTLS</a>", RFC 8447, DOI 10.17487/RFC8447, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="TS.33.501">[TS.33.501]</b></td>
<td class="top">
<a>3GPP</a>, "<a>Security architecture and procedures for 5G System</a>", 3GPP TS 33.501 16.4.0, September 2020.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> Updated references</h1>
<p id="rfc.section.A.p.1">All the following references in <a href="#RFC5216" class="xref">[RFC5216]</a> are updated as specified below when EAP-TLS is used with TLS 1.3 or higher.  </p>
<p id="rfc.section.A.p.2">All references to <a href="#RFC2560" class="xref">[RFC2560]</a> are updated with <a href="#RFC6960" class="xref">[RFC6960]</a>.  </p>
<p id="rfc.section.A.p.3">All references to <a href="#RFC3280" class="xref">[RFC3280]</a> are updated with <a href="#RFC5280" class="xref">[RFC5280]</a>.  </p>
<p id="rfc.section.A.p.4">All references to <a href="#RFC4282" class="xref">[RFC4282]</a> are updated with <a href="#RFC7542" class="xref">[RFC7542]</a>.  </p>
<h1 id="rfc.acknowledgments"><a href="#rfc.acknowledgments">Acknowledgments</a></h1>
<p id="rfc.section.B.p.1">The authors want to thank Bernard Aboba, Jari Arkko, Alan DeKok, Ari Keraenen, Jouni Malinen, Oleg Pekar, Eric Rescorla, Jim Schaad, Terry Burton, Vesa Torvinen, and Hannes Tschofenig for comments and suggestions on the draft.  </p>
<h1 id="rfc.contributors"><a href="#rfc.contributors">Contributors</a></h1>
<p id="rfc.section.C.p.1">Alan DeKok, FreeRADIUS </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Preu&#223; Mattsson</span> 
	  <span class="n hidden">
		<span class="family-name">Mattsson</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Stockholm</span>,  
		<span class="region"></span>
		<span class="code">164 40</span>
	  </span>
	  <span class="country-name vcardline">Sweden</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:john.mattsson@ericsson.com">john.mattsson@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mohit Sethi</span> 
	  <span class="n hidden">
		<span class="family-name">Sethi</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Jorvas</span>,  
		<span class="region"></span>
		<span class="code">02420</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mohit@piuha.net">mohit@piuha.net</a></span>

  </address>
</div>

</body>
</html>

